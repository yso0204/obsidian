
# App.js

`App.js`는 모든 컴포넌트들의 상위 컴포넌트로, 웹 페이지에 필요한 주요 기능과 컴포넌트들을 관리하는 역할을 한다.

```js
import TabBar from './components/TabBar.js';
import Content from './components/Content.js';

export default function App($app) {
    this.state = {
        currentTab: 'all',
        photos: [],
    };

    const tabBar = new TabBar();
    const content = new Content();
    
    this.setState = (newState) => {
        this.state = newState;
    };
}
```

초기값 설정 및 상태관리용으로 만들어 준 뒤
Tab과 Content 컴포넌트의 상태도 알맞게 업데이트 해주어야 한다.
```js
import TabBar from './components/TabBar.js';
import Content from './components/Content.js';

export default function App($app) {
    this.state = {
        currentTab: 'all',
        photos: [],
    };

		const tabBar = new TabBar();
    const content = new Content();
    
    this.setState = (newState) => {
        this.state = newState;
        tabBar.setState(this.state.currentTab);
        content.setState(this.state.photos);
    };
}
```

이제 TabBar 컴포넌트에 필요한 상태 및 기능들을 전달해야하는데
초기상태와 버튼을 누르는 기능을 추가한다.
```js
import TabBar from './components/TabBar.js';
import Content from './components/Content.js';
import { request } from './components/api.js';

export default function App($app) {
    this.state = {
        currentTab: 'all',
        photos: [],
    };

    const tabBar = new TabBar({
        initialState: '',
        onClick: async (name) => {
            this.setState({
                ...this.state,
                currentTab: name,
                photos: await request(name),
            });
        },
    });

    const content = new Content();

    this.setState = (newState) => {
        this.state = newState;
        tabBar.setState(this.state.currentTab);
        content.setState(this.state.photos);
    };
}
```

`onClick`함수는 버튼을 누르면 실행되는 함수로, `setState`를 통해 상태가 변경된 것을 반영한다.

이제 초기 모든 동물 사진을 받아오기 위한 `init` 함수를 만들어 api호출을 해야한다.
```js
import TabBar from './components/TabBar.js';
import Content from './components/Content.js';
import { request } from './components/api.js';

export default function App($app) {
    this.state = {
        currentTab: 'all',
        photos: [],
    };

    const tabBar = new TabBar({
        initialState: '',
        onClick: async (name) => {
            this.setState({
                ...this.state,
                currentTab: name,
                photos: await request(name),
            });
        },
    });

    const content = new Content();

    this.setState = (newState) => {
        this.state = newState;
        tabBar.setState(this.state.currentTab);
        content.setState(this.state.photos);
    };

    const init = async () => {
        try {
            const initialPhotos = await request();
            this.setState({
                ...this.state,
                photos: initialPhotos,
            });
        } catch (error) {
            console.log(error);
        }
    };

    init();
}
```

# TabBar.js

App.js에서 전달되는 `initailState`와 `onClick`을 넣어주고
마찬가지로 초기값 설정, 우선 4개의 버튼을 위한 `this.template`을 만들어준다.

```js
export default function Tabbar({ initialState, onClick }) { 
    this.state = {
        initialState
    }
    this.onClick = onClick;

    this.template = () => {
        return `
        <div id="all">전체</div>
        <div id="penguin">펭귄</div>
        <div id="koala">코알라</div>
        <div id="panda">판다</div>
        `;
    }
    this.render = () => {
        console.log(this.template());
    }
    
    this.setState = (newState) => {
        this.state = newState;
        this.render();
    }

}
```

이렇게 하면 브라우저 콘솔에
![](https://i.imgur.com/GUYVOCS.png)

이게 찍히는데 이 흐름을 잠시 보면

| 단계  | 설명                                         |
| --- | ------------------------------------------ |
| 1   | `App` 생성 시 `TabBar`도 함께 생성                 |
| 2   | `App`이 `tabBar.render()`를 호출               |
| 3   | `TabBar.render()` 안에서 `this.template()` 실행 |
| 4   | template() 결과를 `console.log`로 출력           |

아래와 같이 작성해주면 
```js
export default function TabBar({ $app, initialState, onClick }) {
    this.state = initialState;
    this.onClick = onClick;

    this.$target = document.createElement('div');
    this.$target.className = 'tab-bar';
    $app.appendChild(this.$target);

    this.template = () => {
        let temp = `<div id="all">전체</div>
       <div id="penguin">펭귄</div><div id="koala">코알라</div><div id="panda">판다</div>`;
        return temp;
    };

    this.render = () => {
        this.$target.innerHTML = this.template();
    };

    this.setState = (newState) => {
        this.state = newState;
        this.render();
    };
    
    this.render();
}
```

![](https://i.imgur.com/DpprtXY.png)

사진처럼 요소들이 생겼지만, 클릭이나 다른 것들이 구현이 안되어 아무런 동작이 없다.

```js
export default function Tabbar({ $app,initialState, onClick }) { 
    this.state = {
        initialState
    }
    this.onClick = onClick;

    this.$target = document.createElement('div');
    this.$target.className = 'tab-bar';
    $app.appendChild(this.$target);

    this.template = () => {
        return `
        <div id="all">전체</div>
        <div id="penguin">펭귄</div>
        <div id="koala">코알라</div>
        <div id="panda">판다</div>
        `;
    }
    this.render = () => {
        // console.log(this.template());
        this.$target.innerHTML = this.template();

        let $currentTab = document.getElementById(this.state);
        //$currentTab ? $currentTab.className = 'clicked' : '';
        $currentTab && ($currentTab.className = 'clicked');
        //버튼요소들에 onClick 적용
        //4개의 요소를 감싸고 있는 $target에서 div 요소 들을 다 가져옴
        const $tabBar = this.$target.querySelectorAll('div');
        console.log(this.$target)
        console.log($tabBar)
        //tabBar에 click 했을때 onClick 이 동작하도록 작성
        //onClick은 App.js에서 상태의 currentTab을 누른 id 값으로 설정
        $tabBar.forEach((element) => {
            element.addEventListener('click', () => {
                onClick(element.id)
            })
        });

    }
    
    this.setState = (newState) => {
        this.state = newState;
        this.render();
    }

}
```

주석을 써놓긴 했지만, 왜 clicked로 바뀌는 과정을 살펴보면
![](https://i.imgur.com/WDMTc8W.png)

onClick에 들어온 요소의 id가 App.js에서 초기값인 currentTab에 들어가고
```js
    this.state = {
        curreneTab: 'all',
        photos:[],
    }
```
