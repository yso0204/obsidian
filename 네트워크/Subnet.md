# subnet이란?
기존 class 기반의 IP주소 체계는 주소의 낭비가 심했다.
예를 들어 class C는 254개의 host를 할당할 수 있는데, 50개의 호스트의 할당만 필요한 경우 204개의 주소가 낭비되고, 255개의 host가 필요한 경우 Class C 두 개를 받아야 하는데, 이 경우 254개의 주소가 낭비된다.

그리고 network가 커질 경우 broadcast 의 traffic도 커지는데, 1000개가 하나의 network에 있다면 하나의 device가 broadcast를 할 경우 999개의 device가 이를 받아야하고, 이는 network가 느려지고 장비에 부하가 생길 수 있다.

subnet은 이러한 문제를 해결하기 위해 큰 network를 용도에 맞게 잘게 쪼개 주소 낭비도 줄이고 broadcast 범위도 줄인다.

## subnet mask가 하는일

> ip주소가 어디까지가 network이고, 어디부터가 host인지 경계를 정한다.

`192.168.1.100`이라는 IP와 `255.255.255.0`이라는 서브넷 마스크가 있다고 가정
```
IP 주소: 192.168.1.100 11000000.10101000.00000001.01100100 
서브넷 마스크: 255.255.255.0 11111111.11111111.11111111.00000000 
			네트워크 부분 (24비트) 호스트 부분 (8비트)
```
마스크에서 1인 부분은 network ID, 0인 부분은 host ID로 경계를 나눌 수 있다.

## CIDR 표기법
> subnet mask를 짧게 표현하는 방법

/24 는 "앞에서 부터 24비트가 1" 이라는 뜻이다.

|CIDR|서브넷 마스크|호스트 비트|가용 호스트 수|
|---|---|---|---|
|/8|255.0.0.0|24비트|16,777,214|
|/16|255.255.0.0|16비트|65,534|
|/24|255.255.255.0|8비트|254|
|/25|255.255.255.128|7비트|126|
|/26|255.255.255.192|6비트|62|
|/27|255.255.255.224|5비트|30|
|/28|255.255.255.240|4비트|14|
|/29|255.255.255.248|3비트|6|
|/30|255.255.255.252|2비트|2|

여기서 가용 호스트의 수가 -2 씩 빠지는 이유는 첫 주소는 network 주소, 마지막 주소는 broadcast를 위한 주소로 예약되기 때문이다.

## 서브넷팅 예시
만약 `192.168.1.0/24`를 4개의 부서에 나눈다고 생각해보면 /24 는 호스트 비트가 8개이고, 4개의 부서이므로 구분위해서는 2^2 개 즉 2개의 비트가 필요하다.

```
원본: 192.168.1.0/24
      192.168.1.00000000 ~ 192.168.1.11111111
                ──
                이 2비트를 서브넷 구분에 사용

서브넷 1: 192.168.1.0/26   (00)
          네트워크: 192.168.1.0
          호스트:   192.168.1.1 ~ 192.168.1.62
          브로드:   192.168.1.63

서브넷 2: 192.168.1.64/26  (01)
          네트워크: 192.168.1.64
          호스트:   192.168.1.65 ~ 192.168.1.126
          브로드:   192.168.1.127

서브넷 3: 192.168.1.128/26 (10)
          네트워크: 192.168.1.128
          호스트:   192.168.1.129 ~ 192.168.1.190
          브로드:   192.168.1.191

서브넷 4: 192.168.1.192/26 (11)
          네트워크: 192.168.1.192
          호스트:   192.168.1.193 ~ 192.168.1.254
          브로드:   192.168.1.255
```
각 서브넷에 62개의 호스트를 할당할 수 있다.

이렇게 하나의 큰 네트워크를 여러 개의 작은 네트워크(서브넷)으로 나누는 기술을 서브넷팅이라고 한다.
